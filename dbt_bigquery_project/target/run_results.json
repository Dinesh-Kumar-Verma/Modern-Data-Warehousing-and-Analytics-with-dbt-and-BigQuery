{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-07T14:12:39.489517Z", "invocation_id": "467c4630-ee56-4b47-bd9c-78d1072ffc99", "invocation_started_at": "2025-11-07T14:12:05.038336Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:24.056982Z", "completed_at": "2025-11-07T14:12:24.080381Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:24.133956Z", "completed_at": "2025-11-07T14:12:29.174614Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.157935380935669, "adapter_response": {"_message": "CREATE TABLE (18.5k rows, 509.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 18484, "bytes_processed": 521624, "bytes_billed": 10485760, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "2786c9e2-1a40-4d83-acf0-8e7e6aad818d", "slot_ms": 4085}, "message": "CREATE TABLE (18.5k rows, 509.4 KiB processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.erp_cust_az12", "compiled": true, "compiled_code": "SELECT\n    CASE\n        WHEN STARTS_WITH(cid, 'NAS') THEN SUBSTR(cid, 4)\n        ELSE cid\n    END AS cid,\n    CASE\n        WHEN bdate > CURRENT_DATE() THEN NULL\n        ELSE bdate\n    END AS bdate,\n    CASE\n        WHEN UPPER(TRIM(gen)) IN ('F', 'FEMALE') THEN 'Female'\n        WHEN UPPER(TRIM(gen)) IN ('M', 'MALE') THEN 'Male'\n        ELSE 'n/a'\n    END AS gen,\n    CURRENT_DATETIME() AS dwh_create_date\nFROM `bigquery-with-dbt-476815`.`bronze`.`erp_cust_az12`", "relation_name": "`bigquery-with-dbt-476815`.`silver`.`erp_cust_az12`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:24.026428Z", "completed_at": "2025-11-07T14:12:24.077622Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:24.081674Z", "completed_at": "2025-11-07T14:12:29.220303Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.20916223526001, "adapter_response": {"_message": "CREATE TABLE (60.4k rows, 4.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 60398, "bytes_processed": 4539678, "bytes_billed": 10485760, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "03011320-4d41-4f40-bdec-ff6abbd1f71a", "slot_ms": 4604}, "message": "CREATE TABLE (60.4k rows, 4.3 MiB processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.crm_sales_details", "compiled": true, "compiled_code": "SELECT\r\n  sls_ord_num,\r\n  sls_prd_key,\r\n  sls_cust_id,\r\n\r\n  -- Convert numeric date (YYYYMMDD) safely to DATE\r\n  CASE \r\n    WHEN sls_order_dt = 0 OR LENGTH(CAST(sls_order_dt AS STRING)) != 8 THEN NULL\r\n    ELSE PARSE_DATE('%Y%m%d', CAST(sls_order_dt AS STRING))\r\n  END AS sls_order_dt,\r\n\r\n  CASE \r\n    WHEN sls_ship_dt = 0 OR LENGTH(CAST(sls_ship_dt AS STRING)) != 8 THEN NULL\r\n    ELSE PARSE_DATE('%Y%m%d', CAST(sls_ship_dt AS STRING))\r\n  END AS sls_ship_dt,\r\n\r\n  CASE \r\n    WHEN sls_due_dt = 0 OR LENGTH(CAST(sls_due_dt AS STRING)) != 8 THEN NULL\r\n    ELSE PARSE_DATE('%Y%m%d', CAST(sls_due_dt AS STRING))\r\n  END AS sls_due_dt,\r\n\r\n  -- Recalculate sales if original value is missing or inconsistent\r\n  CASE \r\n    WHEN sls_sales IS NULL OR sls_sales <= 0 OR sls_sales != sls_quantity * ABS(sls_price)\r\n      THEN sls_quantity * ABS(sls_price)\r\n    ELSE sls_sales\r\n  END AS sls_sales,\r\n\r\n  sls_quantity,\r\n\r\n  -- Derive price if invalid\r\n  CASE \r\n    WHEN sls_price IS NULL OR sls_price <= 0 \r\n      THEN sls_sales / NULLIF(sls_quantity, 0)\r\n    ELSE sls_price\r\n  END AS sls_price\r\n\r\nFROM `bronze.crm_sales_details`", "relation_name": "`bigquery-with-dbt-476815`.`silver`.`crm_sales_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:24.020458Z", "completed_at": "2025-11-07T14:12:24.078880Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:24.101739Z", "completed_at": "2025-11-07T14:12:29.262827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.25101900100708, "adapter_response": {"_message": "CREATE TABLE (18.5k rows, 880.5 KiB processed)", "code": "CREATE TABLE", "rows_affected": 18484, "bytes_processed": 901588, "bytes_billed": 10485760, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "7b404dcf-ce15-49a7-abd3-48e067d82795", "slot_ms": 15313}, "message": "CREATE TABLE (18.5k rows, 880.5 KiB processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.crm_cust_info", "compiled": true, "compiled_code": "SELECT\n    cst_id,\n    cst_key,\n    TRIM(cst_firstname) AS cst_firstname,\n    TRIM(cst_lastname) AS cst_lastname,\n    CASE\n        WHEN UPPER(TRIM(cst_marital_status)) = 'S' THEN 'Single'\n        WHEN UPPER(TRIM(cst_marital_status)) = 'M' THEN 'Married'\n        ELSE 'n/a'\n    END AS cst_marital_status,\n    CASE\n        WHEN UPPER(TRIM(cst_gndr)) = 'F' THEN 'Female'\n        WHEN UPPER(TRIM(cst_gndr)) = 'M' THEN 'Male'\n        ELSE 'n/a'\n    END AS cst_gndr,\n    cst_create_date,\n    CURRENT_DATETIME() AS dwh_create_date\nFROM (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (PARTITION BY cst_id ORDER BY cst_create_date DESC) AS flag_last\n    FROM `bigquery-with-dbt-476815`.`bronze`.`crm_cust_info`\n    WHERE cst_id IS NOT NULL\n)\nWHERE flag_last = 1", "relation_name": "`bigquery-with-dbt-476815`.`silver`.`crm_cust_info`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:24.066764Z", "completed_at": "2025-11-07T14:12:24.133439Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:24.139576Z", "completed_at": "2025-11-07T14:12:29.308346Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.260096788406372, "adapter_response": {"_message": "CREATE TABLE (397.0 rows, 26.7 KiB processed)", "code": "CREATE TABLE", "rows_affected": 397, "bytes_processed": 27315, "bytes_billed": 10485760, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "2ffa6177-5cab-4d27-b6f2-481b0aec446e", "slot_ms": 33498}, "message": "CREATE TABLE (397.0 rows, 26.7 KiB processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.crm_prd_info", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        prd_id,\n        REPLACE(SUBSTR(prd_key, 1, 5), '-', '_') AS cat_id,\n        SUBSTR(prd_key, 7) AS prd_key,\n        prd_nm,\n        IFNULL(prd_cost, 0) AS prd_cost,\n        CASE\n            WHEN UPPER(TRIM(prd_line)) = 'M' THEN 'Mountain'\n            WHEN UPPER(TRIM(prd_line)) = 'R' THEN 'Road'\n            WHEN UPPER(TRIM(prd_line)) = 'S' THEN 'Other Sales'\n            WHEN UPPER(TRIM(prd_line)) = 'T' THEN 'Touring'\n            ELSE 'n/a'\n        END AS prd_line,\n        CAST(prd_start_dt AS DATE) AS prd_start_dt\n    FROM `bigquery-with-dbt-476815`.`bronze`.`crm_prd_info`\n),\nwith_end_date AS (\n    SELECT\n        *,\n        DATE_SUB(LEAD(prd_start_dt) OVER (PARTITION BY prd_key ORDER BY prd_start_dt), INTERVAL 1 DAY) AS prd_end_dt\n    FROM base\n)\nSELECT\n    prd_id, cat_id, prd_key, prd_nm, prd_cost, prd_line, prd_start_dt, prd_end_dt,\n    CURRENT_DATETIME() AS dwh_create_date\nFROM with_end_date", "relation_name": "`bigquery-with-dbt-476815`.`silver`.`crm_prd_info`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:29.188814Z", "completed_at": "2025-11-07T14:12:29.193628Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:29.194892Z", "completed_at": "2025-11-07T14:12:34.142696Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.961397409439087, "adapter_response": {"_message": "CREATE TABLE (18.5k rows, 410.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 18485, "bytes_processed": 420490, "bytes_billed": 10485760, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "79e52d93-e301-4f5e-ade2-1bb7af677ee2", "slot_ms": 3457}, "message": "CREATE TABLE (18.5k rows, 410.6 KiB processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.erp_loc_a101", "compiled": true, "compiled_code": "SELECT\n    REPLACE(cid, '-', '') AS cid,\n    CASE\n        WHEN TRIM(cntry) = 'DE' THEN 'Germany'\n        WHEN TRIM(cntry) IN ('US', 'USA') THEN 'United States'\n        WHEN TRIM(cntry) IS NULL OR TRIM(cntry) = '' THEN 'n/a'\n        ELSE TRIM(cntry)\n    END AS cntry,\n    CURRENT_DATETIME() AS dwh_create_date\nFROM `bigquery-with-dbt-476815`.`bronze`.`erp_loc_a101`", "relation_name": "`bigquery-with-dbt-476815`.`silver`.`erp_loc_a101`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:29.245185Z", "completed_at": "2025-11-07T14:12:29.251451Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:29.252821Z", "completed_at": "2025-11-07T14:12:35.171855Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.930545330047607, "adapter_response": {"_message": "CREATE TABLE (37.0 rows, 1.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 37, "bytes_processed": 1124, "bytes_billed": 10485760, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "ec92506d-0f34-4491-8375-9a12a02fa92e", "slot_ms": 4180}, "message": "CREATE TABLE (37.0 rows, 1.1 KiB processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.erp_px_cat_g1v2", "compiled": true, "compiled_code": "SELECT\n    id,\n    cat,\n    subcat,\n    maintenance,\n    CURRENT_DATETIME() AS dwh_create_date\nFROM `bigquery-with-dbt-476815`.`bronze`.`erp_px_cat_g1v2`", "relation_name": "`bigquery-with-dbt-476815`.`silver`.`erp_px_cat_g1v2`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:34.165706Z", "completed_at": "2025-11-07T14:12:34.180219Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:34.182351Z", "completed_at": "2025-11-07T14:12:36.188051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.0295674800872803, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "4786cff0-791c-4366-891e-fd608e11816d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.dim_customers", "compiled": true, "compiled_code": "SELECT\n  ROW_NUMBER() OVER (ORDER BY ci.cst_id) AS customer_key,  -- Surrogate key\n  ci.cst_id AS customer_id,\n  ci.cst_key AS customer_number,\n  ci.cst_firstname AS first_name,\n  ci.cst_lastname AS last_name,\n  la.cntry AS country,\n  ci.cst_marital_status AS marital_status,\n  CASE\n    WHEN ci.cst_gndr != 'n/a' THEN ci.cst_gndr  -- CRM is the primary source for gender\n    ELSE COALESCE(ca.gen, 'n/a')                -- Fallback to ERP data\n  END AS gender,\n  ca.bdate AS birthdate,\n  ci.cst_create_date AS create_date\nFROM `bigquery-with-dbt-476815`.`silver`.`crm_cust_info` AS ci\nLEFT JOIN `bigquery-with-dbt-476815`.`silver`.`erp_cust_az12` AS ca\n  ON ci.cst_key = ca.cid\nLEFT JOIN `bigquery-with-dbt-476815`.`silver`.`erp_loc_a101` AS la\n  ON ci.cst_key = la.cid", "relation_name": "`bigquery-with-dbt-476815`.`gold`.`dim_customers`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:35.182512Z", "completed_at": "2025-11-07T14:12:35.194122Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:35.195150Z", "completed_at": "2025-11-07T14:12:37.204897Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.029266119003296, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "69423b39-159e-45df-8f94-f2bc4cb82468", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.dim_products", "compiled": true, "compiled_code": "SELECT\n  ROW_NUMBER() OVER (ORDER BY pn.prd_start_dt, pn.prd_key) AS product_key,  -- Surrogate key\n  pn.prd_id AS product_id,\n  pn.prd_key AS product_number,\n  pn.prd_nm AS product_name,\n  pn.cat_id AS category_id,\n  pc.cat AS category,\n  pc.subcat AS subcategory,\n  pc.maintenance AS maintenance,\n  pn.prd_cost AS cost,\n  pn.prd_line AS product_line,\n  pn.prd_start_dt AS start_date\nFROM `bigquery-with-dbt-476815`.`silver`.`crm_prd_info` AS pn\nLEFT JOIN `bigquery-with-dbt-476815`.`silver`.`erp_px_cat_g1v2` AS pc\n  ON pn.cat_id = pc.id\nWHERE pn.prd_end_dt IS NULL  -- Filter out all historical data", "relation_name": "`bigquery-with-dbt-476815`.`gold`.`dim_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T14:12:37.223881Z", "completed_at": "2025-11-07T14:12:37.232770Z"}, {"name": "execute", "started_at": "2025-11-07T14:12:37.235142Z", "completed_at": "2025-11-07T14:12:39.469875Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.2500295639038086, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "bigquery-with-dbt-476815", "job_id": "75b988bd-a806-418b-a7d8-de395af59aa6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bigquery_project.fact_sales", "compiled": true, "compiled_code": "SELECT\n  sd.sls_ord_num AS order_number,\n  pr.product_key AS product_key,\n  cu.customer_key AS customer_key,\n  sd.sls_order_dt AS order_date,\n  sd.sls_ship_dt AS shipping_date,\n  sd.sls_due_dt AS due_date,\n  sd.sls_sales AS sales_amount,\n  sd.sls_quantity AS quantity,\n  sd.sls_price AS price\nFROM `bigquery-with-dbt-476815`.`silver`.`crm_sales_details` AS sd\nLEFT JOIN `bigquery-with-dbt-476815`.`gold`.`dim_products` AS pr\n  ON sd.sls_prd_key = pr.product_number\nLEFT JOIN `bigquery-with-dbt-476815`.`gold`.`dim_customers` AS cu\n  ON sd.sls_cust_id = cu.customer_id", "relation_name": "`bigquery-with-dbt-476815`.`gold`.`fact_sales`", "batch_results": null}], "elapsed_time": 23.055357694625854, "args": {"state_modified_compare_vars": false, "invocation_command": "dbt run", "log_format": "default", "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": true, "select": [], "populate_cache": true, "introspect": true, "require_resource_names_without_spaces": true, "project_dir": "C:\\Users\\Dinesh Kumar Verma\\Desktop\\Modern_Data_Warehousing_and_Analytics_with_dbt_and_BigQuery\\dbt_bigquery_project", "static_parser": true, "log_level_file": "debug", "require_generic_test_arguments_property": true, "which": "run", "printer_width": 80, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_yaml_configuration_for_mf_time_spines": false, "send_anonymous_usage_stats": true, "require_all_warnings_handled_by_warn_error": false, "upload_to_artifacts_ingest_api": false, "indirect_selection": "eager", "macro_debugging": false, "log_format_file": "debug", "empty": false, "validate_macro_args": false, "quiet": false, "show_resource_report": false, "write_json": true, "log_level": "info", "log_file_max_bytes": 10485760, "print": true, "require_nested_cumulative_type_params": false, "favor_state": false, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "show_all_deprecations": false, "source_freshness_run_project_hooks": true, "log_path": "C:\\Users\\Dinesh Kumar Verma\\Desktop\\Modern_Data_Warehousing_and_Analytics_with_dbt_and_BigQuery\\dbt_bigquery_project\\logs", "profiles_dir": "C:\\Users\\Dinesh Kumar Verma\\Desktop\\Modern_Data_Warehousing_and_Analytics_with_dbt_and_BigQuery\\dbt_bigquery_project", "vars": {}, "defer": false, "cache_selected_only": false, "strict_mode": false, "require_batched_execution_for_custom_microbatch_strategy": false, "exclude": [], "partial_parse": true, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "use_colors_file": true, "use_fast_test_edges": false}}